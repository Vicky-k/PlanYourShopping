<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
      <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>
  <script type="text/javascript"
  src="http://maps.googleapis.com/maps/api/js?libraries=weather&sensor=false">
</script>
      <script>
      var welcome = document.getElementById('welcome');
          welcome.innerHTML = localStorage.getItem("username") ;
function findOut(){
	
	var item = document.getElementById('Item').value;
    var city = document.getElementById('city').value;
    var state = document.getElementById('state').value;
    var tmp = city.indexOf(":");
    var city2 = city.substring(tmp+1, city.length);
    alert(city2);
var name="one.xml";
var url = "http://www.SupermarketAPI.com/api.asmx/StoresByCityState?APIKEY=abb0645e0a&SelectedCity="+city+"&SelectedState="+state;
//downloadURI();
//setTimeout(read, 6000);
    function ajaxRequest(){
 var activexmodes=["Msxml2.XMLHTTP", "Microsoft.XMLHTTP"]; //activeX versions to check for in IE
 if (window.ActiveXObject){ //Test for support for ActiveXObject in IE first (as XMLHttpRequest in IE7 is broken
  for (var i=0; i<activexmodes.length; i++){
   try{
    return new ActiveXObject(activexmodes[i]);
   }
   catch(e){
    //suppress error
   }
  }
 }
 else if (window.XMLHttpRequest) // if Mozilla, Safari etc
 {
     
  return new XMLHttpRequest();
 }
 else
  return false
}
read();
/*function downloadURI() 
{
    
    var link = document.createElement("a");
    link.download = name;
    link.href = url;
    link.click();
}*/
function read(){
    
var mygetrequest=new ajaxRequest();
if (mygetrequest.overrideMimeType){
 mygetrequest.overrideMimeType('text/xml');
 }
mygetrequest.onreadystatechange=function(){
 if (mygetrequest.readyState==4){
     
  if (mygetrequest.status==200 || window.location.href.indexOf("http")==-1){
   var xmldata=mygetrequest.responseXML //retrieve result as an XML object
         
            myFunction(xmldata);
  }
     else
     {
         alert("An error has occured making the request")
  }
 }
}
mygetrequest.open("GET", "http://www.SupermarketAPI.com/api.asmx/StoresByCityState?APIKEY=abb0645e0a&SelectedCity="+city2+"&SelectedState="+state, true);
mygetrequest.send();
function myFunction(xmlDoc) {
 
var x1 = xmlDoc.getElementsByTagName("Storename");
var x2 = xmlDoc.getElementsByTagName("Address");
var x3 = xmlDoc.getElementsByTagName("City");
var x4 = xmlDoc.getElementsByTagName("State");
var x5 = xmlDoc.getElementsByTagName("Zip");
var x6 = xmlDoc.getElementsByTagName("StoreId");
var table="<table style='width:100%'><tr><th align='left'><font size='4'>Storename</font></th><th align='left'><font size='4'>Address</font></th><th align='left'><font size='4'>City</font></th><th align='left'><font size='4'>State</font></th><th align='left'><font size='4'>Zip</font></th><th align='left'><font size='4'>StoreID</font></th></tr>"; 
    var str = "bbbbbbbbbbbbbbbb";
for (var i = 0; i <(x1.length); i++) { 
    
    table += "<tr><td>" +
  x1[i].childNodes[0].nodeValue + "</td>"  + 
  "<td>" + x2[i].childNodes[0].nodeValue + "</td>" +
   "<td>" + x3[i].childNodes[0].nodeValue + "</td>" +
   "<td>" + x4[i].childNodes[0].nodeValue + "</td>" +
    "<td>" + x5[i].childNodes[0].nodeValue + "</td>" +
     "<td>" + x6[i].childNodes[0].nodeValue + "</td>" +
  "</tr>";
 
}
table+="</table>";
document.getElementById("id01").innerHTML = table;

            
}
}	
		}
    
    
    
    
    function findOut2(){
	
	var item = document.getElementById('Item').value;
    var storeid = document.getElementById('storeid').value;
var name="one.xml";
var url = "http://www.SupermarketAPI.com/api.asmx/SearchForItem?APIKEY=abb0645e0a&StoreId="+storeid+"&ItemName="+item;
//downloadURI();
//setTimeout(read, 6000);
        function ajaxRequest(){
 var activexmodes=["Msxml2.XMLHTTP", "Microsoft.XMLHTTP"]; //activeX versions to check for in IE
 if (window.ActiveXObject){ //Test for support for ActiveXObject in IE first (as XMLHttpRequest in IE7 is broken
  for (var i=0; i<activexmodes.length; i++){
   try{
    return new ActiveXObject(activexmodes[i]);
   }
   catch(e){
    //suppress error
   }
  }
 }
 else if (window.XMLHttpRequest) // if Mozilla, Safari etc
 {
     
  return new XMLHttpRequest();
 }
 else
  return false
}
read();
        
/*function downloadURI() 
{
    
    var link = document.createElement("a");
    link.download = name;
    link.href = url;
    link.click();
}*/
function read(){
 
var mygetrequest=new ajaxRequest();
if (mygetrequest.overrideMimeType){
 mygetrequest.overrideMimeType('text/xml');
 }
mygetrequest.onreadystatechange=function(){
 if (mygetrequest.readyState==4){
     
  if (mygetrequest.status==200 || window.location.href.indexOf("http")==-1){
   var xmldata=mygetrequest.responseXML //retrieve result as an XML object
         
            myFunction(xmldata);
  }
     else
     {
         alert("An error has occured making the request")
  }
 }
}
mygetrequest.open("GET", "http://www.SupermarketAPI.com/api.asmx/SearchForItem?APIKEY=abb0645e0a&StoreId="+storeid+"&ItemName="+item, true);
mygetrequest.send();
function myFunction(xmlDoc) {
 
var x1 = xmlDoc.getElementsByTagName("Itemname");
var x2 = xmlDoc.getElementsByTagName("ItemDescription");
var x3 = xmlDoc.getElementsByTagName("ItemCategory");
var x4 = xmlDoc.getElementsByTagName("ItemID");
var x5 = xmlDoc.getElementsByTagName("AisleNumber");
var x6 = xmlDoc.getElementsByTagName("Pricing");
var table="<table style='width:100%'><tr><th align='left'><font size='4'>Itemname</font></th><th align='left'><font size='4'>ItemDescription</font></th><th align='left'><font size='4'>ItemCategory</font></th><th align='left'><font size='4'>ItemID</font></th><th align='left'><font size='4'>AisleNumber</font></th></tr>";
    alert("hello");
for (var i = 0; i <(x1.length); i++) { 
  table += "<tr><td>" +
  x1[i].childNodes[0].nodeValue + "</td>"  + 
  "<td>" + x2[i].childNodes[0].nodeValue + "</td>" +
   "<td>" + x3[i].childNodes[0].nodeValue + "</td>" +
   "<td>" + x4[i].childNodes[0].nodeValue + "</td>" +
    "<td>" + x5[i].childNodes[0].nodeValue + "</td>";
 
}
table+="</table>";
document.getElementById("id01").innerHTML = table;
}
}	
		}
          
          
          
          function locationStorage()
          {
              
              var city = document.getElementById('city').value;
              var tmp = city.indexOf(":");
              var city2 = city.substring(tmp+1, city.length);
              alert(document.getElementById('state').value + " " + city2);
              
              localStorage.setItem("state", document.getElementById('state').value );
              localStorage.setItem("city", city2);
              
              window.location.assign("maplocator.html");
          }
          
          
          
		  
      </script>
      
  </head>
  <body ng-app="starter" bgcolor="#2EFE2E">
      
      <h3 align="center">Welcome to Dashboard</h3>
      <div id="hello">
      </div> </br>
      <div id="welcome" align="centre" ng-controller="location">    
            <u>Select the state and city in which you want to serach for stores and products</u> </br></br>
            choose state:  <select id="state" ng-model="state" ng-change="stateChanged()">
                    <option value=''>-- choose state --</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    
                    <option value="AZ">Arkansas</option>
                    <option value="AR">Arizona</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="FL">Florida</option>    
                    <option value="GA">Georgia</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississipi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NC">North carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New york</option>
                    <option value="OH">Ohio</option>    
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennysylvania</option>
                    <option value="RI">Rhode island</option>
                    <option value="SC">South carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennesse</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermount</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                    <option value="DC">District of Columbia</option>
            </select>
            &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
            choose City: <select id="city" ng-model="city" ng-options="o as o for o in cities">
                    <option value=''>-- choose city --</option>
            </select>
            
                
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<button id="btn" style="width:300px;height:28px;bgcolor:00FF33" onclick="findOut()">
                                 Display stores
                </button>
                &nbsp&nbsp
            </div>
                
            </br></br>
<div>
<u>Select the item to be searched in your desired store</u></br>
Enter Item:  <input type="text"  id="Item" style="width:300px;height:28px;bgcolor:00FF33"></input>
Enter StoreID:  <input type="text"  id="storeid" style="width:300px;height:28px;bgcolor:00FF33"></input>               
   </br>  &nbsp&nbsp&nbsp<button id="btn2" style="width:300px;height:28px;bgcolor:00FF33" onclick="findOut2()">
                                 Display items list            
           
                    </button>
        &nbsp&nbsp&nbsp<button id="btn3" style="width:300px;height:28px;bgcolor:00FF33" onclick="locationStorage()">
                                 Show on Maps            
           
                    </button>
</div>
    <div id="id01"></div>
    
    </br></br>
    

  </body>
</html>

<script>
     var hello = document.getElementById('hello');
hello.innerHTML = "Hello  " + localStorage.getItem("username") ;
      </script>